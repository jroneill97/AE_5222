clc; clear; close all;
hw2_2017_main;
% funciton inputs: (x,y,psi)
% given: x_bar(n), v_n, theta(n)

syms x y
N_p   = threat_basis_data.n_threat_parameters;
theta = threat_parameters_true;
x_bar = threat_basis_data.basis_parameters.mean(1,:);
y_bar = threat_basis_data.basis_parameters.mean(2,:);
v_n   = threat_basis_data.basis_parameters.var;
c_off = 3;
V     = 0.1;

f = @(n) (theta(n)*(x-x_bar(n))/(sqrt(2*pi*v_n)*v_n)) * ...
exp(-(1/(2*v_n))*(x-x_bar(n))^2 + (y-y_bar(n))^2);

w_x=@(n) (-1*theta(n)*(x-x_bar(n))/(sqrt(2*pi)*v_n^1.5))* ...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/-2*v_n);

w_y=@(n) (-1*theta(n)*(y-y_bar(n))/(sqrt(2*pi)*v_n^1.5))* ...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/-2*v_n);

=@(n) (-1*(theta(n)*(x-x_bar(n)^2)/(1*sqrt(2*pi)*v_n^2.5)+...
    theta(n)/(sqrt(2*pi)*vn^1.5))*...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/(-2*v_n))); % dwx_dx

=@(n) ((-1*theta(n)*(x-x_bar(n))*(y-y_bar(n)))/(-1*sqrt(2*pi)*v_^2.5))*...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/(-2*v_n));  % dwx_dy

=@(n) ((-1*theta(n)*(x-x_bar(n))*(y-y_bar(n)))/(-1*sqrt(2*pi)*v_^2.5))*...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/(-2*v_n));  %

dwy_dy=@(n) (-1*(theta(n)*(y-y_bar(n)^2)/(1*sqrt(2*pi)*v_n^2.5)+...
    theta(n)/(sqrt(2*pi)*vn^1.5))*...
    exp(((x-x_bar(n))^2+(y-y_bar(n))^2)/(-2*v_n)));

c = c_off;
for n = 1:N_p
c = c + f(n);
end





p_1 = -c/(V*cos(psi) + w_x + tan(psi)*(V*sin(psi) + w_y));
P_2 = (-tan(psi)*c)/(V*cos(psi) + w_x + tan(psi)*(V*sin(psi) + w_y))